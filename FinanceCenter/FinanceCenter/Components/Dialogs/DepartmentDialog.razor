@using FinanceCenter.Data.Entities

<div class="dialog-overlay @(IsVisible ? "visible" : "")" @onclick="HandleOverlayClickAsync">
	<div class="dialog-container" @onclick:stopPropagation="true">
		@* 對話窗標題 *@
		<header class="dialog-header">
			<div class="dialog-header-icon @(IsEdit ? "edit" : "add")">
				@if (IsEdit)
				{
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
						<path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/>
						<path d="m15 5 4 4"/>
					</svg>
				}
				else
				{
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
						<line x1="12" y1="5" x2="12" y2="19"/>
						<line x1="5" y1="12" x2="19" y2="12"/>
					</svg>
				}
			</div>
			<div class="dialog-header-text">
				<h2>@(IsEdit ? "編輯部門" : "新增部門")</h2>
				<p>@(IsEdit ? "修改部門資訊" : "建立新的部門")</p>
			</div>
			<button type="button" class="dialog-close-btn" @onclick="CancelAsync" aria-label="關閉">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
					<line x1="18" y1="6" x2="6" y2="18"/>
					<line x1="6" y1="6" x2="18" y2="18"/>
				</svg>
			</button>
		</header>

		@* 對話窗內容 *@
		<div class="dialog-content">
			<EditForm Model="Department" OnValidSubmit="SubmitAsync">
				<DataAnnotationsValidator />
				
				@* 部門代號 *@
				<div class="form-group">
					<label for="dept-code">
						<span class="label-icon">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
								<path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
								<line x1="7" y1="7" x2="7.01" y2="7"/>
							</svg>
						</span>
						部門代號
						<span class="required-mark">*</span>
					</label>
					<input type="text"
						   id="dept-code"
						   @bind="Department.Code"
						   @bind:event="oninput"
						   placeholder="例如：HR、IT、FIN"
						   disabled="@IsEdit"
						   class="@(IsEdit ? "disabled" : "")"
						   required />
					<p class="form-hint">
						@if (IsEdit)
						{
							<span class="hint-locked">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
									<rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
									<path d="M7 11V7a5 5 0 0 1 10 0v4"/>
								</svg>
								部門代號建立後不可修改
							</span>
						}
						else
						{
							<text>請輸入唯一的部門代號</text>
						}
					</p>
				</div>

				@* 部門名稱 *@
				<div class="form-group">
					<label for="dept-name">
						<span class="label-icon">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
								<path d="M3 21h18"/>
								<path d="M9 8h1"/>
								<path d="M9 12h1"/>
								<path d="M9 16h1"/>
								<path d="M14 8h1"/>
								<path d="M14 12h1"/>
								<path d="M14 16h1"/>
								<path d="M5 21V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16"/>
							</svg>
						</span>
						部門名稱
						<span class="required-mark">*</span>
					</label>
					<input type="text"
						   id="dept-name"
						   @bind="Department.Name"
						   @bind:event="oninput"
						   placeholder="例如：人力資源部"
						   required />
				</div>

				@* 啟用狀態 *@
				<div class="form-group status-group">
					<div class="status-card">
						<div class="status-info">
							<span class="status-label">啟用狀態</span>
							<span class="status-desc">
								@(Department.IsActive ? "此部門目前為啟用狀態" : "此部門目前為停用狀態")
							</span>
						</div>
						<label class="toggle-switch">
							<input type="checkbox" @bind="Department.IsActive" />
							<span class="toggle-slider"></span>
						</label>
					</div>
				</div>

				@* 對話窗按鈕 *@
				<div class="dialog-actions">
					<button type="button" class="btn-secondary" @onclick="CancelAsync">
						取消
					</button>
					<button type="submit" class="btn-primary" disabled="@(!IsFormValid)">
						@if (IsEdit)
						{
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
								<path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
								<polyline points="17 21 17 13 7 13 7 21"/>
								<polyline points="7 3 7 8 15 8"/>
							</svg>
							<span>儲存變更</span>
						}
						else
						{
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
								<line x1="12" y1="5" x2="12" y2="19"/>
								<line x1="5" y1="12" x2="19" y2="12"/>
							</svg>
							<span>新增部門</span>
						}
					</button>
				</div>
			</EditForm>
		</div>
	</div>
</div>
